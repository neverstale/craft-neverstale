{#
Neverstale Plugin Dashboard Template

@author Zaengle
@package neverstale/neverstale
@since 1.0.0
#}

{%- extends '_layouts/cp' %}
{%- import '_includes/forms' as forms %}

{% do view.registerAssetBundle('neverstale\\neverstale\\assets\\NeverstaleAsset') %}

{%- set crumbs = [
    { label: 'Neverstale' | t('neverstale'), url: url('neverstale') },
] %}

{%- set title = '' %}
{%- set selectedSubnavItem = 'dashboard' %}


{% block content %}
    <div class="neverstale-welcome">
        <div class="neverstale-welcome hero readable">
            <div class="main">
                <div class="icon">
                    <svg viewBox="0 0 214 32" fill="none" xmlns="http://www.w3.org/2000/svg" class="block h-6 md:h-8">
                        <path d="M106.765 19.757H93.4923C93.9499 22.7918 96.0789 24.7704 98.9476 24.7704C101.093 24.7704 102.92 23.6409 103.962 21.699L106.168 22.9218C104.783 25.6154 102.131 27.2161 98.9476 27.2161C94.1869 27.2161 90.8157 23.58 90.8157 18.4732C90.8157 13.3663 94.1256 9.94958 98.8863 9.94958C103.647 9.94958 106.769 13.4598 106.769 18.5707V19.761L106.765 19.757ZM104.178 17.4697C103.798 14.3658 101.812 12.4563 98.9149 12.4563C96.0176 12.4563 93.8355 14.3739 93.4596 17.4697H104.182H104.178Z"
                              fill="currentColor"></path>
                        <path d="M123.033 10.4209L116.948 26.7205H113.168L107.084 10.4209H109.793L114.995 24.3682H115.248L120.45 10.4209H123.033Z"
                              fill="currentColor"></path>
                        <path d="M139.305 19.757H126.032C126.49 22.7918 128.619 24.7704 131.487 24.7704C133.633 24.7704 135.459 23.6409 136.502 21.699L138.708 22.9218C137.323 25.6154 134.671 27.2161 131.487 27.2161C126.727 27.2161 123.356 23.58 123.356 18.4732C123.356 13.3663 126.666 9.94958 131.426 9.94958C136.187 9.94958 139.309 13.4598 139.309 18.5707V19.761L139.305 19.757ZM136.718 17.4697C136.338 14.3658 134.352 12.4563 131.455 12.4563C128.558 12.4563 126.375 14.3739 125.999 17.4697H136.722H136.718Z"
                              fill="currentColor"></path>
                        <path d="M143.718 26.7164H141.197V15.3571C141.197 12.2531 143.036 10.4005 146.117 10.4005H149.901V12.7529H146.117C144.605 12.7529 143.718 13.7076 143.718 15.1986V26.7164Z"
                              fill="currentColor"></path>
                        <path d="M150.951 14.5283C150.951 11.8022 153.538 9.92114 156.876 9.92114C159.966 9.92114 162.393 11.5178 163.149 14.057L160.722 14.7761C160.28 13.2404 158.891 12.2694 156.876 12.2694C155.111 12.2694 153.472 12.9885 153.472 14.4633C153.472 15.7471 154.355 16.2793 157.792 17.0634C160.881 17.7825 164.036 18.5382 164.036 21.9224C164.036 25.526 160.472 27.1552 157.383 27.1552C154.134 27.1552 150.837 25.7901 150.199 21.8412L152.68 21.4511C153.129 24.0147 155.05 24.8029 157.383 24.8029C158.96 24.8029 161.514 23.9578 161.514 22.0443C161.514 20.7483 160.632 20.212 157.195 19.4198C154.106 18.6925 150.951 17.9328 150.951 14.5201V14.5283Z"
                              fill="currentColor"></path>
                        <path d="M174.46 24.3682V26.7205H171.939C168.858 26.7205 167.019 24.8679 167.019 21.764V12.7813H163.709V10.4371H167.019V4.90369H169.54V10.429L174.456 10.4209V12.7732L169.54 12.7813V21.9265C169.54 23.4175 170.423 24.3722 171.939 24.3722H174.46V24.3682Z"
                              fill="currentColor"></path>
                        <path d="M192.052 24.3682V26.7205H190.948C189.718 26.7205 188.693 25.8429 188.472 24.6851H188.186C186.883 26.2655 185.003 27.1918 182.784 27.1918C178.436 27.1918 175.408 23.645 175.408 18.5707C175.408 13.4963 178.44 9.94958 182.784 9.94958C185.003 9.94958 186.878 10.8759 188.186 12.4563H188.427V10.4209H190.948V23.7425C190.948 24.0878 191.23 24.3682 191.578 24.3682H192.052ZM188.427 18.5707C188.435 15.353 186.707 12.3141 183.18 12.3019C179.637 12.31 177.937 15.353 177.929 18.5707C177.937 21.8087 179.633 24.8476 183.18 24.8394C186.707 24.8476 188.435 21.8087 188.427 18.5707Z"
                              fill="currentColor"></path>
                        <path d="M213.996 19.757H200.723C201.181 22.7918 203.31 24.7704 206.179 24.7704C208.324 24.7704 210.151 23.6409 211.193 21.699L213.399 22.9218C212.014 25.6154 209.362 27.2161 206.179 27.2161C201.418 27.2161 198.047 23.58 198.047 18.4732C198.047 13.3663 201.357 9.94958 206.117 9.94958C210.878 9.94958 214 13.4598 214 18.5707V19.761L213.996 19.757ZM211.409 17.4697C211.029 14.3658 209.043 12.4563 206.146 12.4563C203.249 12.4563 201.066 14.3739 200.691 17.4697H211.409Z"
                              fill="currentColor"></path>
                        <path d="M196.465 3.46143H193.944V26.7164H196.465V3.46143Z" fill="currentColor"></path>
                        <path d="M88.9237 4.74525V26.7205H84.49L73.5303 7.15851H73.2769V26.7205H70.6943V4.74525H75.1281L86.0878 24.3072H86.3411V4.74525H88.9237Z"
                              fill="currentColor"></path>
                        <path d="M38.8494 0V15.999H54.9416C54.9456 7.16664 47.7373 0 38.8494 0Z" fill="#D6DD21"></path>
                        <path d="M27.4728 4.68456C21.1879 -1.55983 10.9965 -1.55983 4.7116 4.68456L16.0922 15.9992H0C0 24.8316 7.20839 31.9982 16.0922 31.9982V15.9992L27.4728 27.3139C33.7576 33.5624 43.9491 33.5624 50.2299 27.3139L38.8493 15.9992L27.4687 4.68456H27.4728Z"
                              fill="#D6DD21"></path>
                    </svg>
                </div>
                <p>{{ 'Track and manage stale content in your Craft CMS projects.' | t('neverstale') }}</p>
            </div>
        </div>

        <div class="neverstale-quick-actions" style="margin-top: 2rem; margin-bottom: 2rem;">
            <nav style="display: flex; gap: 0; border: 1px solid #e3e5e8; border-radius: 6px; overflow: hidden; background: #fff;">
                <a href="{{ url('neverstale/content') }}" class="neverstale-nav-item">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" style="margin-right: 8px;">
                        <path d="M3 2.5A1.5 1.5 0 014.5 1h7A1.5 1.5 0 0113 2.5v11a1.5 1.5 0 01-1.5 1.5h-7A1.5 1.5 0 013 13.5v-11zM4.5 2a.5.5 0 00-.5.5v11a.5.5 0 00.5.5h7a.5.5 0 00.5-.5v-11a.5.5 0 00-.5-.5h-7z"/>
                        <path d="M5 4h6v1H5V4zm0 2h6v1H5V6zm0 2h4v1H5V8z"/>
                    </svg>
                    {{ 'View Content' | t('neverstale') }}
                </a>
                <a href="{{ url('neverstale/settings') }}" class="neverstale-nav-item">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" style="margin-right: 8px;">
                        <path d="M8 4.754a3.246 3.246 0 100 6.492 3.246 3.246 0 000-6.492zM5.754 8a2.246 2.246 0 114.492 0 2.246 2.246 0 01-4.492 0z"/>
                        <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 01-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 01-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 01.52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 011.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 011.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 01.52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 01-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 01-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 002.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 001.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 00-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 00-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 00-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 001.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 003.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 002.692-1.115l.094-.319z"/>
                    </svg>
                    {{ 'Settings' | t('neverstale') }}
                </a>
                <a href="{{ url('neverstale/bulk-ingest') }}" class="neverstale-nav-item">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" style="margin-right: 8px;">
                        <path d="M1.5 1a.5.5 0 00-.5.5v4a.5.5 0 01-1 0v-4A1.5 1.5 0 011.5 0h4a.5.5 0 010 1h-4zM11 .5a.5.5 0 01.5-.5h4A1.5 1.5 0 0117 1.5v4a.5.5 0 01-1 0v-4a.5.5 0 00-.5-.5h-4a.5.5 0 01-.5-.5zM.5 11a.5.5 0 01.5.5v4a.5.5 0 00.5.5h4a.5.5 0 010 1h-4A1.5 1.5 0 010 15.5v-4a.5.5 0 01.5-.5zm15 0a.5.5 0 01.5.5v4a1.5 1.5 0 01-1.5 1.5h-4a.5.5 0 010-1h4a.5.5 0 00.5-.5v-4a.5.5 0 01.5-.5z"/>
                        <path d="M3 3h10v10H3V3zm9 1H4v8h8V4z"/>
                    </svg>
                    {{ 'Bulk Ingest' | t('neverstale') }}
                </a>
            </nav>
        </div>

        <div class="neverstale-content-summary">
            <div class="field">
                <div class="heading">
                    <h3>{{ 'Content Evaluation Summary' | t('neverstale') }}</h3>
                </div>
                <div class="instructions">
                    <p>{{ 'Overview of your content analysis status across enabled sections:' | t('neverstale') }}</p>
                </div>

                {% if contentStats.total > 0 %}
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-top: 1rem;">
                        <div class="neverstale-stat-card">
                            <div class="neverstale-stat-number">{{ contentStats.total }}</div>
                            <div class="neverstale-stat-label">{{ 'Total Entries' | t('neverstale') }}</div>
                        </div>
                        <div class="neverstale-stat-card neverstale-stat-flagged">
                            <div class="neverstale-stat-number">{{ contentStats.flagged }}</div>
                            <div class="neverstale-stat-label">{{ 'Flagged' | t('neverstale') }}</div>
                        </div>
                        <div class="neverstale-stat-card neverstale-stat-synced">
                            <div class="neverstale-stat-number">{{ contentStats.synced }}</div>
                            <div class="neverstale-stat-label">{{ 'Synced' | t('neverstale') }}</div>
                        </div>
                        <div class="neverstale-stat-card neverstale-stat-pending">
                            <div class="neverstale-stat-number">{{ contentStats.pending }}</div>
                            <div class="neverstale-stat-label">{{ 'Pending' | t('neverstale') }}</div>
                        </div>
                    </div>

                    {% if contentStats.recentEntries is not empty %}
                        <div style="margin-top: 1.5rem;">
                            <h4>{{ 'Recent Flagged Content' | t('neverstale') }}</h4>
                            <div style="display: flex; flex-direction: column; gap: 0.5rem; margin-top: 0.5rem;">
                                {% for item in contentStats.recentEntries %}
                                    <div style="display: flex; align-items: center; justify-content: space-between; padding: 0.5rem; background: #f9f9f9; border-radius: 4px;">
                                        <div>
                                            <a href="{{ item.entry.cpEditUrl }}"
                                               style="font-weight: 500; text-decoration: none;">
                                                {{ item.entry.title ?: 'Untitled' }}
                                            </a>
                                            <div style="font-size: 0.875rem; color: #666;">
                                                {{ item.entry.section ? item.entry.section.name : 'Unknown Section' }}
                                            </div>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                <span style="background: #fef3c7; color: #92400e; padding: 2px 6px; border-radius: 12px; font-size: 11px; font-weight: 600;">
                  {{ item.flagCount == 1 ? '1 flag' : item.flagCount ~ ' flags' }}
                </span>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    {% endif %}

                {% else %}
                    <div class="neverstale-empty-state"
                         style="text-align: center; padding: 2rem; background: #f8f9fa; border-radius: 8px; margin-top: 1rem;">
                        <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"
                             style="color: #9ca3af; margin: 0 auto 1rem auto; display: block;">
                            <path d="M24 4C12.954 4 4 12.954 4 24s8.954 20 20 20 20-8.954 20-20S35.046 4 24 4zm-2 30h4v4h-4v-4zm0-24h4v20h-4V10z"
                                  fill="currentColor"/>
                        </svg>
                        <h4 style="margin: 0 0 0.5rem 0; color: #374151;">{{ 'No Content Analyzed Yet' | t('neverstale') }}</h4>
                        <p style="margin: 0; color: #6b7280;">{{ 'Start by submitting content for analysis or check your section configuration.' | t('neverstale') }}</p>
                    </div>
                {% endif %}
            </div>
        </div>


        <div class="neverstale-external-links"
             style="margin-top: 2rem; padding-top: 2rem; border-top: 1px solid #e3e5e8;">
            <div class="field">
                <div class="heading">
                    <h3>{{ 'External Resources' | t('neverstale') }}</h3>
                </div>
                <div class="instructions">
                    <p>{{ 'Access documentation and manage your Neverstale account:' | t('neverstale') }}</p>
                </div>
                <div style="display: flex; gap: 1.5rem; margin-top: 1rem; margin-bottom: 3rem;">
                    <a href="https://docs.neverstale.com" class="go"
                       target="_blank">{{ 'Documentation' | t('neverstale') }}</a>
                    <a href="https://app.neverstale.com" class="go"
                       target="_blank">{{ 'Neverstale Web App' | t('neverstale') }}</a>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
